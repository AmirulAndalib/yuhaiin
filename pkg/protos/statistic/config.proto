syntax = "proto3";

package yuhaiin.statistic;

option go_package = "github.com/Asutorufa/yuhaiin/pkg/protos/statistic";

import "google/protobuf/empty.proto";

service connections {
  rpc conns(google.protobuf.Empty) returns (conn_resp);
  rpc close_conn(close_conns_req) returns (google.protobuf.Empty);
  rpc statistic(google.protobuf.Empty) returns (stream rate_resp);
}

message close_conns_req { repeated int64 conns = 1; }

message rate_resp {
  string download = 1 [ json_name = "download" ];
  string upload = 2 [ json_name = "upload" ];
  ;
  string download_rate = 3 [ json_name = "download_rate" ];
  string upload_rate = 4 [ json_name = "upload_rate" ];
}

message conn_resp {
  message connection {
    string addr = 1 [ json_name = "addr" ];
    int64 id = 2 [ json_name = "id" ];
    string local = 3 [ json_name = "local" ];
    string remote = 4 [ json_name = "remote" ];
    string mark = 5 [ json_name = "mark" ];
  }
  repeated connection connections = 1 [ json_name = "connections" ];
}